import{_ as a,c as n,o as e,ag as i}from"./chunks/framework.8SQNO8WI.js";const k=JSON.parse('{"title":"systemd示例-一次运行和后台运行","description":"","frontmatter":{},"headers":[],"relativePath":"Linux系统/ubuntu桌面/systemd示例-一次运行和后台运行.md","filePath":"Linux系统/ubuntu桌面/systemd示例-一次运行和后台运行.md","lastUpdated":1717736585000}'),p={name:"Linux系统/ubuntu桌面/systemd示例-一次运行和后台运行.md"};function t(l,s,h,d,c,r){return e(),n("div",null,[...s[0]||(s[0]=[i(`<h1 id="systemd示例-一次运行和后台运行" tabindex="-1">systemd示例-一次运行和后台运行 <a class="header-anchor" href="#systemd示例-一次运行和后台运行" aria-label="Permalink to &quot;systemd示例-一次运行和后台运行&quot;">​</a></h1><h2 id="常用操作-可以复制参考" tabindex="-1">常用操作（可以复制参考） <a class="header-anchor" href="#常用操作-可以复制参考" aria-label="Permalink to &quot;常用操作（可以复制参考）&quot;">​</a></h2><p>编辑服务文件</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system/verysync.service</span></span></code></pre></div><p>重新加载服务文件</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span></code></pre></div><p>查看服务状态</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> verysync.service</span></span></code></pre></div><p>重启服务</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> verysync.service</span></span></code></pre></div><p>关闭服务</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> verysync.service</span></span></code></pre></div><p>开机自启动</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> verysync.service</span></span></code></pre></div><p>关闭开机自启动</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> verysync.service</span></span></code></pre></div><h2 id="一次运行" tabindex="-1">一次运行 <a class="header-anchor" href="#一次运行" aria-label="Permalink to &quot;一次运行&quot;">​</a></h2><p>适用于开机自动运行一次后完成初始化的操作</p><p>下面的代码用于解决ubuntu 24 不能启动docker desktop的问题</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Unit]</span></span>
<span class="line"><span>Description=Disable AppArmor Restriction on Unprivileged User Namespaces</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Service]</span></span>
<span class="line"><span>Type=oneshot</span></span>
<span class="line"><span>ExecStart=/sbin/sysctl -w kernel.apparmor_restrict_unprivileged_userns=0</span></span>
<span class="line"><span>RemainAfterExit=true</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Install]</span></span>
<span class="line"><span>WantedBy=multi-user.target</span></span></code></pre></div><h2 id="后台运行" tabindex="-1">后台运行 <a class="header-anchor" href="#后台运行" aria-label="Permalink to &quot;后台运行&quot;">​</a></h2><p>这个是启动后台服务</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Unit]</span></span>
<span class="line"><span>Description=微力同步</span></span>
<span class="line"><span>After=network.target</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Service]</span></span>
<span class="line"><span>Type=simple</span></span>
<span class="line"><span>WorkingDirectory=/home/w/MY_PROGRAM/verysync</span></span>
<span class="line"><span>ExecStart=/home/w/MY_PROGRAM/verysync/verysync</span></span>
<span class="line"><span>Restart=on-failure</span></span>
<span class="line"><span>User=w</span></span>
<span class="line"><span>Group=w</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Install]</span></span>
<span class="line"><span>WantedBy=multi-user.target</span></span>
<span class="line"><span>Reload systemd and enable the service:</span></span></code></pre></div>`,23)])])}const u=a(p,[["render",t]]);export{k as __pageData,u as default};
