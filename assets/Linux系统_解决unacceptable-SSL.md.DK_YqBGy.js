import{_ as s,c as i,o as e,ag as t}from"./chunks/framework.8SQNO8WI.js";const k=JSON.parse('{"title":"解决Linux系统中的SSL证书错误 (Unacceptable SSL certificate)","description":"","frontmatter":{},"headers":[],"relativePath":"Linux系统/解决unacceptable-SSL.md","filePath":"Linux系统/解决unacceptable-SSL.md","lastUpdated":1756115712000}'),n={name:"Linux系统/解决unacceptable-SSL.md"};function l(c,a,p,h,d,r){return e(),i("div",null,[...a[0]||(a[0]=[t(`<h1 id="解决linux系统中的ssl证书错误-unacceptable-ssl-certificate" tabindex="-1">解决Linux系统中的SSL证书错误 (Unacceptable SSL certificate) <a class="header-anchor" href="#解决linux系统中的ssl证书错误-unacceptable-ssl-certificate" aria-label="Permalink to &quot;解决Linux系统中的SSL证书错误 (Unacceptable SSL certificate)&quot;">​</a></h1><blockquote><p>gemini辅助生成</p></blockquote><p>在Linux系统中，尤其是在使用 <code>curl</code>、<code>wget</code>、<code>git</code> 或包管理器（如 <code>apt</code>）等工具访问网络资源时，你可能会遇到与SSL/TLS证书相关的错误，例如 <code>unacceptable SSL certificate</code> 或 <code>certificate verification failed</code>。这类问题通常指向系统的根证书信任链出现了问题。</p><p>本文将分析该问题的常见原因，并提供一套行之有效的解决方案。</p><h2 id="问题现象" tabindex="-1">问题现象 <a class="header-anchor" href="#问题现象" aria-label="Permalink to &quot;问题现象&quot;">​</a></h2><p>当你尝试访问一个 <code>https://</code> 协议的网站时，终端可能会报出以下类似的错误：</p><ul><li><code>curl: (60) SSL certificate problem: unable to get local issuer certificate</code></li><li><code>fatal: unable to access &#39;https://github.com/&#39;: server certificate verification failed. CAfile: /etc/ssl/certs/ca-certificates.crt CRLfile: none</code></li><li><code>wget: ERROR: The certificate of ‘example.com’ is not trusted.</code></li></ul><h2 id="原因分析" tabindex="-1">原因分析 <a class="header-anchor" href="#原因分析" aria-label="Permalink to &quot;原因分析&quot;">​</a></h2><p>这类问题的核心原因通常是<strong>系统无法验证远程服务器提供的SSL证书的合法性</strong>。这往往由以下几点导致：</p><ol><li><strong>系统根证书文件损坏或丢失</strong>：这是最常见的原因。在Debian/Ubuntu系统中，根证书由 <code>ca-certificates</code> 包管理。所有的受信任的CA根证书最终会被整合成一个单一的文件，通常是 <code>/etc/ssl/certs/ca-certificates.crt</code>。如果这个文件被意外删除、权限错误或内容损坏，系统就失去了验证SSL证书的能力。</li><li><strong>系统时间不正确</strong>：如果你的系统时间与标准时间相差太大，会导致SSL证书验证失败（因为证书都有一个有效期范围）。</li><li><strong>缺少特定的根证书</strong>：有些时候，系统默认的根证书库可能没有包含某个网站所使用的（较新的或较少见的）CA根证书。</li></ol><h2 id="解决方案" tabindex="-1">解决方案 <a class="header-anchor" href="#解决方案" aria-label="Permalink to &quot;解决方案&quot;">​</a></h2><p>针对以上原因，我们可以采用以下步骤来排查和修复。</p><h3 id="方案一-更新和重新配置证书" tabindex="-1">方案一：更新和重新配置证书 <a class="header-anchor" href="#方案一-更新和重新配置证书" aria-label="Permalink to &quot;方案一：更新和重新配置证书&quot;">​</a></h3><p>这应该是首选的修复方法。它会利用 <code>ca-certificates</code> 包自带的工具来重新生成证书信任链。</p><p><code>update-ca-certificates</code> 是一个用于更新 <code>/etc/ssl/certs</code> 目录的工具。它会读取 <code>/usr/share/ca-certificates/</code> 目录下的所有证书，并将它们整合成 <code>/etc/ssl/certs/ca-certificates.crt</code> 文件。</p><p>执行以下命令：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># -f, --fresh: 表示强制重新生成，即使看起来没有变化</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># -v, --verbose: 显示详细的执行过程</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update-ca-certificates</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --fresh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span></code></pre></div><p>执行后，它会列出新添加或移除的证书数量。完成后，你可以再次尝试之前失败的网络命令。</p><h3 id="方案二-彻底重装证书包-终极方案" tabindex="-1">方案二：彻底重装证书包（终极方案） <a class="header-anchor" href="#方案二-彻底重装证书包-终极方案" aria-label="Permalink to &quot;方案二：彻底重装证书包（终极方案）&quot;">​</a></h3><p>如果更新配置后问题依旧，或者你怀疑 <code>ca-certificates</code> 包本身已损坏，可以采取更彻底的重装策略。</p><p>这个方法会强制重新安装证书管理包，并触发证书的重新配置，可以修复绝大多数由于文件丢失或损坏导致的问题。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 首先，确保你的包列表是最新的</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 强制重新安装 ca-certificates 包</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reinstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ca-certificates</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. （可选，但建议执行）再次手动更新证书缓存</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update-ca-certificates</span></span></code></pre></div><p>执行完毕后，系统中的根证书应该已经恢复到健康状态。</p><h3 id="辅助检查-检查系统时间" tabindex="-1">辅助检查：检查系统时间 <a class="header-anchor" href="#辅助检查-检查系统时间" aria-label="Permalink to &quot;辅助检查：检查系统时间&quot;">​</a></h3><p>如果以上方法都无效，请务必检查你的系统时间是否准确。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看当前系统时间</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span></span></code></pre></div><p>如果时间不正确，你可以使用 <code>timedatectl</code> 或 <code>ntpdate</code> 等工具来同步网络时间。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 timedatectl (推荐)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> timedatectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-ntp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或者使用 ntpdate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ntp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ntpdate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> time.nist.gov</span></span></code></pre></div><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>SSL证书问题是网络连接中的常见障碍。当遇到 <code>unacceptable SSL certificate</code> 等相关错误时，不要慌张。首先应检查系统时间，然后尝试使用 <code>update-ca-certificates</code> 进行快速修复。如果问题依然存在，通过 <code>apt-get install --reinstall ca-certificates</code> 进行彻底重装，几乎总能解决问题。保持系统根证书的完整和更新，是确保网络通信安全的基础。</p>`,30)])])}const u=s(n,[["render",l]]);export{k as __pageData,u as default};
