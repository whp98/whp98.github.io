import{_ as i,c as a,o as e,ag as t}from"./chunks/framework.8SQNO8WI.js";const c=JSON.parse('{"title":"Hyper-V端口占用解决","description":"","frontmatter":{},"headers":[],"relativePath":"Windows系统/Hyper-V端口占用解决.md","filePath":"Windows系统/Hyper-V端口占用解决.md","lastUpdated":1717397989000}'),p={name:"Windows系统/Hyper-V端口占用解决.md"};function l(n,s,h,r,d,k){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="hyper-v端口占用解决" tabindex="-1">Hyper-V端口占用解决 <a class="header-anchor" href="#hyper-v端口占用解决" aria-label="Permalink to &quot;Hyper-V端口占用解决&quot;">​</a></h1><h2 id="情况" tabindex="-1">情况 <a class="header-anchor" href="#情况" aria-label="Permalink to &quot;情况&quot;">​</a></h2><p>某一天tomcat起不来，提示端口被占用，但是找了半天没有找到是哪个程序占用了。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Caused by: java.net.BindException: Address already in use: bind</span></span></code></pre></div><p>后来上网一查原来是windows占用了一些动态端口给hyper-v用，这个是可以设置的。</p><p>于是按照下面操作了一下解决了问题。</p><h2 id="解决方案" tabindex="-1">解决方案 <a class="header-anchor" href="#解决方案" aria-label="Permalink to &quot;解决方案&quot;">​</a></h2><p>分为三步</p><ol><li>关闭Hyper-V</li></ol><p>管理员运行</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dism.exe</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Online </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Disable-Feature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:Microsoft</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Hyper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">V</span></span></code></pre></div><ol start="2"><li>设置保留端口范围</li></ol><p>管理员运行</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">netsh int ipv4 set dynamicport tcp start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">netsh int ipv4 set dynamicport udp start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> num</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20000</span></span></code></pre></div><p>端口分配从三万开始最高两万个。</p><ol start="3"><li>开启Hyper-V</li></ol><p>管理员运行</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">dism.exe</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Online </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Enable-Feature</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:Microsoft</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Hyper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">V </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">All</span></span></code></pre></div><h2 id="查看成果" tabindex="-1">查看成果 <a class="header-anchor" href="#查看成果" aria-label="Permalink to &quot;查看成果&quot;">​</a></h2><p>查看当前占用端口</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">netsh interface ipv4 show excludedportrange protocol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tcp</span></span></code></pre></div><p>经过我实测除了带星号的哪个其余的端口无法绑定，spring-boot无法绑定到这些占用的端口。</p><p>查看动态端口分配范围</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">netsh int ipv4 show dynamicport tcp</span></span></code></pre></div><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>windows麻烦死了，不但学会使用，更要会维护。</p>`,26)])])}const g=i(p,[["render",l]]);export{c as __pageData,g as default};
